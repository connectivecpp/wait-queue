<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wait Queue: /github/workspace/example/threaded_queue_buffer_demo.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Wait Queue
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_cfafba98a580ce4b62f8a6fa96d7cbb0.html">example</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">threaded_queue_buffer_demo.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Multithreaded demo of <code>chops::shared_buffer</code> and <code><a class="el" href="classchops_1_1wait__queue.html">chops::wait_queue</a></code>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;cstdlib&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &lt;thread&gt;</code><br />
<code>#include &lt;functional&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;atomic&gt;</code><br />
<code>#include &lt;future&gt;</code><br />
<code>#include &lt;ctime&gt;</code><br />
<code>#include &quot;queue/wait_queue.hpp&quot;</code><br />
<code>#include &quot;marshall/shared_buffer.hpp&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for threaded_queue_buffer_demo.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="threaded__queue__buffer__demo_8cpp__incl.png" border="0" usemap="#a_2github_2workspace_2example_2threaded__queue__buffer__demo_8cpp" alt=""/></div>
<map name="a_2github_2workspace_2example_2threaded__queue__buffer__demo_8cpp" id="a_2github_2workspace_2example_2threaded__queue__buffer__demo_8cpp">
<area shape="rect" title="Multithreaded demo of chops::shared_buffer and chops::wait_queue." alt="" coords="425,5,604,61"/>
<area shape="rect" title=" " alt="" coords="5,109,77,135"/>
<area shape="poly" title=" " alt="" coords="425,51,274,77,93,111,92,106,273,72,424,46"/>
<area shape="rect" title=" " alt="" coords="101,109,160,135"/>
<area shape="poly" title=" " alt="" coords="425,55,176,111,175,106,424,50"/>
<area shape="rect" title=" " alt="" coords="184,109,242,135"/>
<area shape="poly" title=" " alt="" coords="425,63,257,111,256,106,424,58"/>
<area shape="rect" title=" " alt="" coords="266,109,320,135"/>
<area shape="poly" title=" " alt="" coords="446,64,335,107,333,102,444,59"/>
<area shape="rect" title=" " alt="" coords="344,109,402,135"/>
<area shape="poly" title=" " alt="" coords="471,64,407,103,404,98,469,59"/>
<area shape="rect" title=" " alt="" coords="426,109,504,135"/>
<area shape="poly" title=" " alt="" coords="501,63,482,97,477,94,497,60"/>
<area shape="rect" title=" " alt="" coords="528,109,602,135"/>
<area shape="poly" title=" " alt="" coords="532,60,552,94,548,97,528,63"/>
<area shape="rect" title=" " alt="" coords="627,109,687,135"/>
<area shape="poly" title=" " alt="" coords="560,59,625,98,623,103,558,64"/>
<area shape="rect" title=" " alt="" coords="711,109,766,135"/>
<area shape="poly" title=" " alt="" coords="586,59,698,102,696,107,584,64"/>
<area shape="rect" title=" " alt="" coords="789,109,842,135"/>
<area shape="poly" title=" " alt="" coords="605,57,775,106,773,111,604,62"/>
<area shape="rect" href="wait__queue_8hpp_source.html" title=" " alt="" coords="866,109,1016,135"/>
<area shape="poly" title=" " alt="" coords="605,50,866,103,865,108,604,55"/>
<area shape="rect" title=" " alt="" coords="1041,109,1217,135"/>
<area shape="poly" title=" " alt="" coords="605,44,1028,104,1027,109,604,50"/>
<area shape="rect" title=" " alt="" coords="565,183,629,208"/>
<area shape="poly" title=" " alt="" coords="875,138,645,185,644,179,873,133"/>
<area shape="rect" title=" " alt="" coords="653,183,709,208"/>
<area shape="poly" title=" " alt="" coords="896,138,725,184,724,179,895,133"/>
<area shape="rect" title=" " alt="" coords="733,183,789,208"/>
<area shape="poly" title=" " alt="" coords="911,138,804,180,802,175,909,133"/>
<area shape="rect" title=" " alt="" coords="813,183,938,208"/>
<area shape="poly" title=" " alt="" coords="932,137,899,173,895,169,928,133"/>
<area shape="rect" title=" " alt="" coords="962,183,1048,208"/>
<area shape="poly" title=" " alt="" coords="954,133,986,169,982,173,950,137"/>
<area shape="rect" title=" " alt="" coords="1072,183,1138,208"/>
<area shape="poly" title=" " alt="" coords="970,133,1064,174,1062,179,968,138"/>
<area shape="rect" title=" " alt="" coords="1162,183,1213,208"/>
<area shape="poly" title=" " alt="" coords="986,133,1148,179,1146,184,984,138"/>
<area shape="rect" title=" " alt="" coords="1238,183,1319,208"/>
<area shape="poly" title=" " alt="" coords="1000,133,1223,180,1222,185,999,138"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDeviceDataGenerator.html">DeviceDataGenerator</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDataProcessor.html">DataProcessor</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDatabase.html">Database</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classThreadManagement.html">ThreadManagement</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:abaa7567eb6d9c02cadd244fc5af6e2b5" id="r_abaa7567eb6d9c02cadd244fc5af6e2b5"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="threaded__queue__buffer__demo_8cpp.html#abaa7567eb6d9c02cadd244fc5af6e2b5">device_q_t</a> = <a class="el" href="classchops_1_1wait__queue.html">chops::wait_queue</a>&lt; int &gt;</td></tr>
<tr class="separator:abaa7567eb6d9c02cadd244fc5af6e2b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40f13c84cb0c5e05980768090e7d8735" id="r_a40f13c84cb0c5e05980768090e7d8735"><td class="memItemLeft" align="right" valign="top"><a id="a40f13c84cb0c5e05980768090e7d8735" name="a40f13c84cb0c5e05980768090e7d8735"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>data_q_t</b> = <a class="el" href="classchops_1_1wait__queue.html">chops::wait_queue</a>&lt; chops::const_shared_buffer &gt;</td></tr>
<tr class="separator:a40f13c84cb0c5e05980768090e7d8735"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac38ddcc07c3f2ea2c93e0398af517e24" id="r_ac38ddcc07c3f2ea2c93e0398af517e24"><td class="memTemplParams" colspan="2"><a id="ac38ddcc07c3f2ea2c93e0398af517e24" name="ac38ddcc07c3f2ea2c93e0398af517e24"></a>
template&lt;class C &gt; </td></tr>
<tr class="memitem:ac38ddcc07c3f2ea2c93e0398af517e24"><td class="memTemplItemLeft" align="right" valign="top">const char *&#160;</td><td class="memTemplItemRight" valign="bottom"><b>cast_to_char_ptr</b> (const C buf)</td></tr>
<tr class="separator:ac38ddcc07c3f2ea2c93e0398af517e24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97" id="r_a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top"><a id="a0ddf1224851353fc92bfbff6f499fa97" name="a0ddf1224851353fc92bfbff6f499fa97"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>main</b> (int argc, char *argv[])</td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Multithreaded demo of <code>chops::shared_buffer</code> and <code><a class="el" href="classchops_1_1wait__queue.html">chops::wait_queue</a></code>. </p>
<dl class="section author"><dt>Author</dt><dd>Thurman Gillespy</dd></dl>
<p>Copyright (c)2019 by Thurman Gillespy 3/22/19</p>
<p>Distributed under the Boost Software License, Version 1.0. (See accompanying file LICENSE.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt">http://www.boost.org/LICENSE_1_0.txt</a>)</p>
<p>Sample make file: g++ -std=c++17 -I ~/Projects/utility-rack/include/ multithreaded_demo.cpp -lpthread </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="abaa7567eb6d9c02cadd244fc5af6e2b5" name="abaa7567eb6d9c02cadd244fc5af6e2b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaa7567eb6d9c02cadd244fc5af6e2b5">&#9670;&#160;</a></span>device_q_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="threaded__queue__buffer__demo_8cpp.html#abaa7567eb6d9c02cadd244fc5af6e2b5">device_q_t</a> =  <a class="el" href="classchops_1_1wait__queue.html">chops::wait_queue</a>&lt;int&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Project Overview</p>
<p>This demo program shows how to use <code><a class="el" href="classchops_1_1wait__queue.html">chops::wait_queue</a></code> and <code>chops::shared_buffer</code> in a multithreaded environment. The program simulates multiple peripheral data generators, perhaps sensors or network connections. THe data is handled by one or more data processors, which sorts and formats the data, and periodically sends it to a simulated database.</p>
<p>The program can have 1 or more <a class="el" href="classDeviceDataGenerator.html">DeviceDataGenerator</a> threads that each put 20 random numbers into device_q, a <code><a class="el" href="classchops_1_1wait__queue.html">chops::wait_queue</a></code>. Over 1000 threads can be run sucessfully (default is 20). Each <a class="el" href="classDeviceDataGenerator.html">DeviceDataGenerator</a> thread generates random numbers in its' own 'centile': thread 0: &lt;0..99&gt;; thread 1: &lt;100..199&gt;; thread 2: &lt;200-299&gt;, etc.</p>
<p>The device_q numbers are read by 1 or more (default is 5) <a class="el" href="classDataProcessor.html">DataProcessor</a> threads. The numbers are sorted by centile. When 5 numbers in the same centile are collected, a string with the numbers is created that is placed into data_q, another wait_queue of type <code>chops::wait_queue&lt;chops::const_shared_buffer&gt;&gt;</code>, ie, the string is copied into a new <code>chops::const_shared_buffer</code> in the data_q. The first number in the string is the 'index' that correspons to that centile, and the remaining numbers are kept in chronologic order.</p>
<p>0 87 17 65 5 32s 8 870 813 808 827 874</p>
<p>The data_q is read by the single <a class="el" href="classDatabase.html">Database</a> thread. The string is extracted from the data_q and appened to the proper centile string in the database.</p>
<p>When the <a class="el" href="classDatabase.html">Database</a> thread is finished, a 'Data Report' is printed. Each row contains the random nubmers created by a particular thread, in chronlogic order.</p>
<p>Data Report [0] 30 71 2 99 60 74 11 70 4 41 83 90 14 72 68 68 88 51 28 78 [1] 103 110 186 136 152 187 165 169 108 157 116 138 136 132 153 144 159 144 120 110 [2] 273 215 249 265 218 252 286 239 273 269 242 263 245 249 215 266 214 245 258 214 [3] 387 303 312 350 323 331 343 374 363 371 390 335 367 317 397 341 394 399 341 366 [4] 447 415 448 464 455 489 462 446 440 452 417 426 417 446 427 433 484 431 445 468</p>
<p>Mutex locks and conditional variable signaling is handled within the <code><a class="el" href="classchops_1_1wait__queue.html">chops::wait_queue</a></code> class. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
